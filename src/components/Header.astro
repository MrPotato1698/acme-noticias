---
// Importamos los componentes necesarios
import DropdownMenu from "./DropdownMenu.astro";

// Simulamos la obtención del usuario actual (esto se reemplazaría con tu lógica de autenticación real)
const isLoggedIn = Astro.cookies.has("session");
let userRole = "";

if (isLoggedIn) {
  // En un caso real, obtendrías el rol desde tu sesión o base de datos
  userRole = Astro.cookies.get("userRole")?.value || "redactor";
}
---

<header class="bg-[#2a2b2a] text-[#fcf7f8] shadow-md mb-20">
  <div class="container mx-auto px-4 py-3">
    <div class="flex justify-between items-center">
      <!-- Logo -->
      <a href="/" class="flex items-center space-x-2">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-8 w-8 text-[#a31621]"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path
            d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"
          ></path>
          <path d="M18 14h-8"></path>
          <path d="M15 18h-5"></path>
          <path d="M10 6h8v4h-8V6Z"></path>
        </svg>
        <span class="font-bold text-xl">IBÑ News: Acme Noticias</span>
      </a>

      <!-- Navegación -->
      <div class="flex items-center space-x-4">
        <!-- Botón de búsqueda -->
        <a
          href="/buscar"
          class="flex items-center space-x-1 px-3 py-2 rounded-md hover:bg-[#23b5d3] hover:text-[#2a2b2a] transition-colors duration-200"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.3-4.3"></path>
          </svg>
          <span>Buscar</span>
        </a>

        <!-- Botón de inicio de sesión o menú de usuario -->
        {
          isLoggedIn ? (
            <div class="relative" id="user-menu-container">
              <button
                id="user-menu-button"
                class="flex items-center space-x-1 px-3 py-2 rounded-md bg-[#a31621] hover:bg-[#8a131c] transition-colors duration-200"
                aria-expanded="false"
                aria-haspopup="true"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
                <span>Mi Cuenta</span>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="m6 9 6 6 6-6" />
                </svg>
              </button>

              <DropdownMenu userRole={userRole} />
            </div>
          ) : (
            <a
              href="/login"
              class="flex items-center space-x-1 px-3 py-2 rounded-md bg-[#a31621] hover:bg-[#8a131c] transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
                <polyline points="10 17 15 12 10 7" />
                <line x1="15" y1="12" x2="3" y2="12" />
              </svg>
              <span>Iniciar Sesión</span>
            </a>
          )
        }
      </div>
    </div>
  </div>
</header>

<script src="@/lib/dropdown.ts"></script>
